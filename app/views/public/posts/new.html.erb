<div class="container pt-5">
  <%= render 'layouts/error', obj: @post %>
  <div class="row d-flex justify-content-center">
    <div class="border p-4 bg-light">
      <div>
        <h3 class="text-center mb-4 font-weight-bold">新規投稿</h3>

        <!--新規写真投稿フォーム-->
        <%= form_with model: @post do |f| %>
          <div class="custom-file">
            <%= f.file_field :image, accept: "image/*", class: "custom-file-input", id: "customFile" %>
            <%= f.label "画像ファイルを選択…", class: "custom-file-label" %>
          </div>
          <div class="form-group my-3">
            <div id="input-counter" class="text-right">0/200</div>
            <%= f.text_area :caption, placeholder: "コメント・#ハッシュタグ投稿をしよう！（最大200文字）", size: "50x10", id: "input-text", class: "form-control" %>
          </div>
          <div class="form-group mb-4">
            <%= f.select :category_id, Category.all.map { |category| [category.name, category.id] }, {prompt: 'カテゴリー選択してください'}, class: "form-control" %>
          </div>
          <div class="d-flex justify-content-around">
            <div class="form-group">
              <%= f.submit '投稿', class: "post-submit" %>
            </div>
            <div class="form-group">
              <%= f.submit '下書きに保存', :name => 'draft', class: "post-draft" %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bs-custom-file-input/dist/bs-custom-file-input.js"></script>
<script>
  bsCustomFileInput.init();

  $(function(){
   $("#input-text").on("keyup", function() {
     let countNum = String($(this).val().length);
     $("#input-counter").text(countNum + "/200");
     if (countNum > 200) {
      $("#input-counter").css("color","red");
    } else {
      $("#input-counter").css("color","black");
    }
   });
  });
</script>